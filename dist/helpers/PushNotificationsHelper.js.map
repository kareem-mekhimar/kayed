{"version":3,"sources":["../../src/helpers/PushNotificationsHelper.js"],"names":["title","body","userId","find","relatedUser","userSubcribtions","console","log","userSub","payload","JSON","stringify","icon","sendNotification","sendNotificationToUser"],"mappings":";;;;;;;;uEAIO,iBAAsCA,KAAtC,EAA6CC,IAA7C,EAAmDC,MAAnD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAE0B,eAAiBC,IAAjB,CAAsB,EAAEC,aAAaF,MAAf,EAAtB,CAF1B;;AAAA;AAECG,wCAFD;;AAGHC,gCAAQC,GAAR,CAAY,wBAAZ,EAAsCF,gBAAtC;AAHG;AAAA;AAAA;AAAA;AAAA,oCAIgBA,gBAJhB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAIKG,+BAJL;;AAKC,+BAAOA,QAAQJ,WAAf;;AAEMK,+BAPP,GAOiBC,KAAKC,SAAL,CAAe;AAC3BX,wCAD2B;AAE3BC,sCAF2B;AAG3BW,kCAAM;AAHqB,yBAAf,CAPjB;AAAA;AAAA,+BAaO,kBAAQC,gBAAR,CAAyBL,OAAzB,EAAkCC,OAAlC,CAbP;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAeK,sB;;;;;AAJtB;;;;AACA;;;;AACA","file":"PushNotificationsHelper.js","sourcesContent":["import User from \"../models/user.model\";\nimport PushNotification from '../models/push.model';\nimport webPush from 'web-push';\n\nexport async function sendNotificationToUser(title, body, userId) {\n\n    let userSubcribtions = await PushNotification.find({ relatedUser: userId });\n    console.log('Found UserSubscribtion', userSubcribtions);\n    for(let userSub of userSubcribtions) {\n        delete userSub.relatedUser;\n\n        const payload = JSON.stringify({\n            title,\n            body,\n            icon: 'https://image.flaticon.com/icons/png/128/148/148921.png'\n          });\n      \n        await webPush.sendNotification(userSub, payload);\n    }\n}\n"]}