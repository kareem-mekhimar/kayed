{"version":3,"sources":["../../src/helpers/PushNotificationsHelper.js"],"names":["title","body","userId","find","relatedUser","userSubcribtions","userSub","payload","JSON","stringify","icon","sendNotification","sendNotificationToUser"],"mappings":";;;;;;;;uEAIO,iBAAsCA,KAAtC,EAA6CC,IAA7C,EAAmDC,MAAnD;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAE0B,eAAiBC,IAAjB,CAAsB,EAAEC,aAAaF,MAAf,EAAtB,CAF1B;;AAAA;AAECG,wCAFD;AAAA;AAAA;AAAA;AAAA;AAAA,oCAGgBA,gBAHhB;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAGKC,+BAHL;;AAIC,+BAAOA,QAAQF,WAAf;;AAEMG,+BANP,GAMiBC,KAAKC,SAAL,CAAe;AAC3BT,wCAD2B;AAE3BC,sCAF2B;AAG3BS,kCAAM;AAHqB,yBAAf,CANjB;AAAA;AAAA,+BAYO,kBAAQC,gBAAR,CAAyBL,OAAzB,EAAkCC,OAAlC,CAZP;;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAeK,sB;;;;;AAJtB;;;;AACA;;;;AACA","file":"PushNotificationsHelper.js","sourcesContent":["import User from \"../models/user.model\";\nimport PushNotification from '../models/push.model';\nimport webPush from 'web-push';\n\nexport async function sendNotificationToUser(title, body, userId) {\n\n    let userSubcribtions = await PushNotification.find({ relatedUser: userId });\n    for(let userSub of userSubcribtions) {\n        delete userSub.relatedUser;\n\n        const payload = JSON.stringify({\n            title,\n            body,\n            icon: 'https://image.flaticon.com/icons/png/128/148/148921.png'\n          });\n      \n        await webPush.sendNotification(userSub, payload);\n    }\n}\n"]}